<platformUi:DialogWindow x:Class="AwsToolkit.VsSdk.Common.CommonUI.CredentialSelectionDialog"
                         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
                         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
                         xmlns:themes="clr-namespace:Amazon.AWSToolkit.Themes;assembly=AWSToolkit"
                         themes:ToolkitThemes.UseToolkitTheme="True"
                         Title="Select Credentials and Region"
                         xmlns:platformUi="clr-namespace:Microsoft.VisualStudio.PlatformUI;assembly=Microsoft.VisualStudio.Shell.15.0"
                         xmlns:commonui="clr-namespace:Amazon.AWSToolkit.CommonUI;assembly=AWSToolkit"
                         xmlns:credentialSelector="clr-namespace:Amazon.AWSToolkit.CommonUI.CredentialSelector;assembly=AWSToolkit"
                         mc:Ignorable="d" 
                         Width="500" Height="300"
                         WindowStartupLocation="CenterOwner">
    <platformUi:DialogWindow.Resources>
        <ResourceDictionary>
            <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
            <commonui:VsImages x:Key="VsImages" />
            <!-- Only show an icon for warning or error states -->
            <Style x:Key="ConnectionImage" TargetType="Image">
                <Setter Property="Visibility" Value="Collapsed" />
                <Style.Triggers>
                    <DataTrigger Binding="{Binding ConnectionStatus}"
                                 Value="{x:Static credentialSelector:CredentialConnectionStatus.Warning}">
                        <Setter Property="Visibility" Value="Visible" />
                        <Setter Property="Source"
                                Value="{Binding Source={StaticResource VsImages}, Path=StatusWarning}" />
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ConnectionStatus}"
                                 Value="{x:Static credentialSelector:CredentialConnectionStatus.Error}">
                        <Setter Property="Visibility" Value="Visible" />
                        <Setter Property="Source"
                                Value="{Binding Source={StaticResource VsImages}, Path=StatusError}" />
                    </DataTrigger>
                    <DataTrigger Binding="{Binding IsConnectionValid}"
                                 Value="True">
                        <Setter Property="Visibility" Value="Visible" />
                        <Setter Property="Source"
                                Value="{Binding Source={StaticResource VsImages}, Path=StatusOK}" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </ResourceDictionary>
    </platformUi:DialogWindow.Resources>
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="18" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="6" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>


        <TextBlock Grid.Row="0" Grid.Column="0"
                   VerticalAlignment="Center"
                   Text="Credentials:" />
        <ComboBox Grid.Row="0" Grid.Column="2"
                  Margin="0 6 0 6"
                  VerticalAlignment="Center"
                  MinWidth="100"
                  SelectedItem="{Binding CredentialIdentifier}"
                  ItemsSource="{Binding Credentials}">
            <ComboBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{Binding DisplayName}" />
                    </StackPanel>
                </DataTemplate>
            </ComboBox.ItemTemplate>
        </ComboBox>

        <TextBlock Grid.Row="1" Grid.Column="0"
                   VerticalAlignment="Center"
                   Text="Region:" />
        <ComboBox Grid.Row="1" Grid.Column="2"
                  Margin="0 6 0 6"
                  VerticalAlignment="Center"
                  MinWidth="100"
                  SelectedItem="{Binding Region}"
                  ItemsSource="{Binding Regions}">
            <ComboBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="{Binding DisplayName}" />
                    </StackPanel>
                </DataTemplate>
            </ComboBox.ItemTemplate>
        </ComboBox>

        <Image
            Grid.Row="2"
            Grid.Column="0"
            Margin="0 6 0 0"
            Height="16" Width="16"
            HorizontalAlignment="Right"
            VerticalAlignment="Center" 
            Style="{StaticResource ConnectionImage}"/>

        <StackPanel
            Grid.Row="2"
            Grid.Column="2"
            Margin="0 6 0 6"
            HorizontalAlignment="Left"
            Orientation="Vertical">
            <TextBlock 
                d:Text="Validation Failure Messages go here"
                Foreground="{DynamicResource {x:Static themes:ToolkitThemes.HintTextBrushKey}}"
                Text="{Binding ConnectionMessage}" />
            <TextBlock
                Visibility="{Binding IsConnectionBad, Converter={StaticResource BooleanToVisibilityConverter}}">
                <Hyperlink Command="{Binding RetryCommand}">
                    Retry
                </Hyperlink>
            </TextBlock>
        </StackPanel>

        <StackPanel
            Grid.Row="4"
            Grid.Column="0"
            Grid.ColumnSpan="3"
            Orientation="Horizontal"
            HorizontalAlignment="Right"
            VerticalAlignment="Bottom">
            <Button
                IsDefault="True"
                Command="{Binding OkCommand}">
                OK
            </Button>
            <Button
                Margin="6 0 0 0"
                IsCancel="True">
                Cancel
            </Button>
        </StackPanel>
    </Grid>
</platformUi:DialogWindow>
