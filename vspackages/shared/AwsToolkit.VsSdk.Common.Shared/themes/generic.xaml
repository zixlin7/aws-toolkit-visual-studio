<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:AwsToolkit.VsSdk.Common.CommonUI"
    xmlns:platformUi="clr-namespace:Microsoft.VisualStudio.PlatformUI;assembly=Microsoft.VisualStudio.Shell.15.0"
    xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework">

    <Style 
        TargetType="{x:Type local:ThemedDialogWindow}"
        BasedOn="{StaticResource {x:Type platformUi:DialogWindowBase}}">

        <Setter Property="ContentTemplate">
            <Setter.Value>
                <DataTemplate>
                    <Grid>
                        <Border
                            Background="{Binding Background, RelativeSource={RelativeSource TemplatedParent}}"
                            BorderThickness="1"
                            BorderBrush="{DynamicResource {x:Static platformUi:ThemedDialogColors.WindowBorderBrushKey}}">
                            <DockPanel LastChildFill="True">
                                <!-- VS would use a GlyphButton in this case, but it's not available for extensions -->
                                <Button
                                    DockPanel.Dock="Top"
                                    Command="{Binding CloseCommand, RelativeSource={RelativeSource AncestorType={x:Type local:ThemedDialogWindow}}}"
                                    Content="&#x2715;"
                                    Foreground="{DynamicResource {x:Static platformUi:ThemedDialogColors.WindowButtonGlyphBrushKey}}"
                                    HorizontalAlignment="Right"
                                    Margin="9 6 9 6"
                                    MinHeight="0"
                                    MinWidth="0">
                                    <!-- Bare bones template to get rid of border, triggers, and other default button stuff -->
                                    <Button.Template>
                                        <ControlTemplate TargetType="{x:Type Button}">
                                            <ContentPresenter />
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                                <ContentControl Content="{Binding Content, RelativeSource={RelativeSource TemplatedParent}}" />
                            </DockPanel>
                        </Border>
                    </Grid>
                </DataTemplate>
            </Setter.Value>
        </Setter>

        <Setter Property="ResizeMode" Value="CanResizeWithGrip" />
        <Setter Property="ShowInTaskbar" Value="False" />

        <!-- https://learn.microsoft.com/en-us/dotnet/api/system.windows.shell.windowchrome?view=netframework-4.7.2
        CornerRadius requires GlassFrameThickness="0" -->
        <Setter Property="shell:WindowChrome.WindowChrome">
            <Setter.Value>
                <shell:WindowChrome
                    CaptionHeight="0"
                    CornerRadius="0"
                    GlassFrameThickness="0"
                    ResizeBorderThickness="5"
                    UseAeroCaptionButtons="False" />
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
