<commonui:BaseAWSUserControl x:Class="Amazon.AWSToolkit.EC2.LaunchWizard.PageUI.AMIOptionsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:commonui="clr-namespace:Amazon.AWSToolkit.CommonUI;assembly=AWSToolkit"                      
    xmlns:awstoolkitcomponents="clr-namespace:Amazon.AWSToolkit.CommonUI.Components;assembly=AWSToolkit"
    xmlns:pageui="clr-namespace:Amazon.AWSToolkit.EC2.LaunchWizard.PageUI"
    >

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/AWSToolkit;component/Themes/DefaultTheme.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid Margin="4">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width=".5*" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width=".5*" />
        </Grid.ColumnDefinitions>

        <Grid Grid.Column="0">

            <Grid.RowDefinitions>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
            </Grid.RowDefinitions>

            <Grid Grid.Row="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width=".8*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width=".2*" />
                </Grid.ColumnDefinitions>

                <Label Target="{Binding ElementName=_instanceTypeSelector}"
                               Style="{DynamicResource awsWizardGroupSubHeaderStyle}">
                    Instance _Type:
                </Label>

                <awstoolkitcomponents:ListViewComboBox 
                                Grid.Column="1"
                                x:Name="_instanceTypeSelector"
                                VerticalAlignment="Center"
                                HorizontalAlignment="Stretch"
                                DisplayMemberPath="Id"
                                ItemContainerStyle="{DynamicResource awsListViewItemContainerStyle}"
                                AlternationCount="2"
                                ItemsSource="{Binding InstanceTypes}">
                    <GridViewColumn Header="Type" DisplayMemberBinding="{Binding Id}" />
                    <GridViewColumn Header="Requires VPC" DisplayMemberBinding="{Binding RequiresVPC}" />
                    <GridViewColumn Header="vCPU" DisplayMemberBinding="{Binding NumberOfVirtualCores}" />
                    <GridViewColumn Header="Memory" DisplayMemberBinding="{Binding MemoryWithUnits}" />
                    <GridViewColumn Header="Disk Space" DisplayMemberBinding="{Binding DiskSpaceWithUnits}" />
                </awstoolkitcomponents:ListViewComboBox>

                <Label Target="{Binding ElementName=_instanceCount}"
                                Style="{DynamicResource awsWizardFieldLabelStyle}"
                                Grid.Column="2"
                                Margin="8,2,2,2">
                    _Count:
                </Label>
                <TextBox x:Name="_instanceCount" 
                         Grid.Column="3"
                         Validation.Error="OnValidationError"
                         Style="{DynamicResource awsTextBoxStyle}">
                    <TextBox.Text>
                        <Binding Path="InstanceCount" 
                             NotifyOnValidationError="True"
                             >
                            <Binding.ValidationRules>
                                <pageui:InstanceCountValidationRule/>
                            </Binding.ValidationRules>
                        </Binding>
                    </TextBox.Text>
                </TextBox>
            </Grid>

            <Grid Grid.Row="1" Margin="0,12,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <Label Grid.Row="0" Grid.Column="0" 
                       VerticalAlignment="Center" 
                       Style="{DynamicResource awsWizardGroupSubHeaderStyle}">
                    Launch Into:
                </Label>

                <RadioButton Grid.Row="0" Grid.Column="1" 
                             Margin="4,0,0,0" 
                             VerticalAlignment="Center" 
                             IsChecked="True" 
                             Name="_ctlLaunchEC2"  
                             GroupName="LauchInto"
                             Style="{DynamicResource awsRadioButtonBaseStyle}">
                    EC2 Availability Zone:
                </RadioButton>
                
                <ComboBox x:Name="_availabilityZone" 
                          Grid.Row="0"
                          Grid.Column="2"
                          VerticalAlignment="Center"
                          Width="150"
                          Cursor="Wait"
                          Margin="4,0,0,0"
                          IsEnabled="{Binding ElementName=_ctlLaunchEC2, Path=IsChecked}"    
                          Style="{DynamicResource awsComboBoxStyle}"/>

                <RadioButton Grid.Row="1" Grid.Column="1" 
                             Margin="4,0,0,0" 
                             VerticalAlignment="Center"                                  
                             IsChecked="False" 
                             Name="_ctlLaunchVPC" 
                             GroupName="LauchInto"
                             Style="{DynamicResource awsRadioButtonBaseStyle}">
                    VPC Subnet:
                </RadioButton>

                <awstoolkitcomponents:ListViewComboBox  
                          x:Name="_vpcSubnets" 
                          Margin="4,4,0,0"
                          Grid.Row="1"                             
                          Grid.Column="2"
                          VerticalAlignment="Center"
                          Cursor="Wait"
                          Width="150"
                          DisplayMemberPath="FormattedSubnet"
                          IsEnabled="{Binding ElementName=_ctlLaunchVPC, Path=IsChecked}"                         
                          ItemsSource="{Binding VpcSubnets}"
                          ItemContainerStyle="{DynamicResource awsListViewItemContainerStyle}"
                          AlternationCount="2">
                    <GridViewColumn Header="Subnet ID" DisplayMemberBinding="{Binding Subnet.DisplayName}" />
                    <GridViewColumn Header="Availability Zone" DisplayMemberBinding="{Binding Subnet.AvailabilityZone}" />
                    <GridViewColumn Header="CIDR" DisplayMemberBinding="{Binding Subnet.CidrBlock}" />
                </awstoolkitcomponents:ListViewComboBox>
            </Grid>

            <StackPanel Grid.Row="2" Margin="0,12,0,0">
                <Label Style="{DynamicResource awsWizardGroupSubHeaderStyle}">
                    User Data
                </Label>

                <Grid Margin="4,0,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <StackPanel Margin="0,0,8,0">
                        <RadioButton x:Name="_userDataAsText" 
                                     IsChecked="True" 
                                     Checked="_userDataAsText_Checked"
                                     Style="{DynamicResource awsRadioButtonBaseStyle}">
                            Use _text:
                        </RadioButton>
                        <RadioButton x:Name="_userDataAsFile"
                                     Checked="_userDataAsFile_Checked"
                                     Margin="0,12,0,0"
                                     Style="{DynamicResource awsRadioButtonBaseStyle}">
                            From _file:
                        </RadioButton>
                    </StackPanel>

                    <TextBox x:Name="_userDataText" 
                             Grid.Column="1" 
                             AcceptsReturn="True"
                             Height="48"
                             TextWrapping="Wrap"
                             Style="{DynamicResource awsTextBoxStyle}"/>

                    <Grid Grid.Column="1" 
                          Height="Auto" 
                          VerticalAlignment="Top" 
                          Visibility="Collapsed"
                          x:Name="_userDataAsFileFields"
                          >
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBox x:Name="_userDataFile" 
                                 Margin="0,26,0,0" 
                                 MaxLines="1" 
                                 Validation.Error="OnValidationError"
                                 Style="{DynamicResource awsTextBoxStyle}">
                            <TextBox.Text>
                                <Binding NotifyOnValidationError="True" Path="UserDataFilename">
                                    <Binding.ValidationRules>
                                        <pageui:UserDataFileValidationRule />
                                    </Binding.ValidationRules>
                                </Binding>
                            </TextBox.Text>
                        </TextBox>
                        <Button x:Name="_userDataFileBrowse" 
                                Grid.Column="1"
                                VerticalAlignment="Center"
                                Click="_userDataFileBrowse_Click"
                                Margin="0,26,0,0">
                            Browse...
                        </Button>
                    </Grid>

                    <CheckBox x:Name="_base64"
                              Grid.Column="2"
                              Grid.Row="1"
                              Margin="0,4,0,0"
                              Style="{DynamicResource awsCheckboxButtonBaseStyle}">
                        base_64 encoded
                    </CheckBox>
                </Grid>

            </StackPanel>

            <Grid Grid.Row="3" Margin="0,12,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <Label Target="{Binding ElementName=_iamProfile}"
                           VerticalAlignment="Center"
                           Style="{DynamicResource awsWizardGroupSubHeaderStyle}">
                    IAM _Role:
                </Label>
                <ComboBox x:Name="_iamProfile" 
                          Grid.Column="1" 
                          Margin="12,0,0,0"
                          Width="200" 
                          HorizontalAlignment="Left" 
                          VerticalAlignment="Center"  
                          IsEditable="False"
                          Cursor="Wait"
                          DisplayMemberPath="InstanceProfileName"
                          Style="{DynamicResource awsComboBoxStyle}"/>
            </Grid>
        </Grid>

        <Border Grid.Column="1"
                BorderThickness="2"
                BorderBrush="Silver"
                Margin="8"
                />

        <Grid Grid.Column="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <StackPanel Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2">
                <Label Style="{DynamicResource awsWizardGroupHeaderStyle}">
                    Advanced Instance Options
                </Label>
                <TextBlock TextWrapping="Wrap" 
                           HorizontalAlignment="Left" 
                           Margin="4,2,4,2" 
                           Style="{DynamicResource awsTextBlockBaseStyle}">
                    You can choose a specific kernel or RAM disk to use with your instances. 
                    You can also choose to enable CloudWatch Detailed Monitoring or enter 
                    data that will be available from your instances once they launch.
                </TextBlock>
            </StackPanel>

            <Grid Grid.Row="1" Margin="0,12,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width=".7*" />
                </Grid.ColumnDefinitions>

                <Label Target="{Binding ElementName=_kernelID}"
                           VerticalAlignment="Center"
                           Style="{DynamicResource awsWizardFieldLabelStyle}">
                    _Kernel ID:
                </Label>
                <ComboBox x:Name="_kernelID" 
                          Grid.Column="1" 
                          HorizontalAlignment="Left" 
                          VerticalAlignment="Center"  
                          MinWidth="150" 
                          IsEditable="False"
                          Cursor="Wait"
                          Style="{DynamicResource awsComboBoxStyle}"/>

                <Label Grid.Row="1" Grid.Column="0" 
                       Target="{Binding ElementName=_ramdiskID}"
                       VerticalAlignment="Center"
                       Style="{DynamicResource awsWizardFieldLabelStyle}"
                       >
                    _RAM Disk ID:
                </Label>
                <ComboBox x:Name="_ramdiskID" 
                          Grid.Row="1" Grid.Column="1" 
                          MinWidth="150" 
                          HorizontalAlignment="Left" 
                          VerticalAlignment="Center"  
                          IsEditable="False"
                          Cursor="Wait"
                          Style="{DynamicResource awsComboBoxStyle}"/>
            </Grid>

            <Grid Grid.Row="2" Margin="0,12,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <Label Style="{DynamicResource awsWizardGroupSubHeaderStyle}">
                    CloudWatch Monitoring
                </Label>

                <CheckBox x:Name="_monitoring" Grid.Row="1"
                          Margin="4,0,0,0"
                            Style="{DynamicResource awsCheckboxButtonBaseStyle}">
                    Enable (additional charges will apply)
                </CheckBox>
            </Grid>

            <Grid Grid.Row="3" Margin="0,12,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <Label Style="{DynamicResource awsWizardGroupSubHeaderStyle}"
                       Grid.ColumnSpan="2">
                    Termination Protection
                </Label>
                
                <CheckBox x:Name="_terminationProtection"
                          Grid.Row="1"
                          Grid.Column="0"
                          Grid.ColumnSpan="2"
                          Margin="4,0,0,0" 
                          Style="{DynamicResource awsCheckboxButtonBaseStyle}">
                    _Prevent against accidental termination
                </CheckBox>

                <ComboBox x:Name="_shutdownBehaviour"
                          Grid.Row="2"
                          Grid.Column="0"
                          SelectedIndex="0"
                          Margin="4,4,0,0"
                          Width="80"
                          Style="{DynamicResource awsComboBoxStyle}">
                    <ComboBoxItem Tag="stop">Stop</ComboBoxItem>
                    <ComboBoxItem Tag="terminate">Terminate</ComboBoxItem>
                </ComboBox>

                <Label Grid.Row="2" 
                       Grid.Column="1"
                       Margin="2,2,0,0"
                       Style="{DynamicResource awsLabelBaseStyle}">
                    instance(s) on _shutdown.
                </Label>
            </Grid>
        </Grid>

    </Grid>
    
</commonui:BaseAWSUserControl>
