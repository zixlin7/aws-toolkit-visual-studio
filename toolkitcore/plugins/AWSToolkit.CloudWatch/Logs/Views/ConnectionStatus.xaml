<UserControl x:Class="Amazon.AWSToolkit.CloudWatch.Logs.Views.ConnectionStatus"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:themes="clr-namespace:Amazon.AWSToolkit.Themes;assembly=AWSToolkit"
             xmlns:converters="clr-namespace:Amazon.AWSToolkit.CommonUI.Converters;assembly=AWSToolkit"
             xmlns:images="clr-namespace:Amazon.AWSToolkit.CommonUI.Images;assembly=AWSToolkit"
             xmlns:commonUi="clr-namespace:Amazon.AWSToolkit.CommonUI;assembly=AWSToolkit"
             themes:ToolkitThemes.UseToolkitTheme="True"
             mc:Ignorable="d"
             d:DesignHeight="450" d:DesignWidth="800">
    <UserControl.Resources>
        <ResourceDictionary>
            <converters:CredentialIdentifierConverter x:Key="CredentialIdentifierConverter" />
            <converters:ToolkitRegionConverter x:Key="ToolkitRegionConverter" />
            <converters:HasValueVisibilityConverter x:Key="HasValueVisibilityConverter"/>
            <commonUi:VsImages x:Key="VsImages" />
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StatusBar
            themes:ToolkitThemes.UseToolkitTheme="True"
            Grid.Row="0" Grid.Column="0">
            <StatusBar.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                    </Grid>
                </ItemsPanelTemplate>
            </StatusBar.ItemsPanel>
            <StatusBarItem>
                <TextBlock
                    Text="{Binding ConnectionSettings, Converter={StaticResource ToolkitRegionConverter}}"
                    ToolTip="AWS region associated with this view"
                    />
            </StatusBarItem>
            <Separator Grid.Column="1" />
            <StatusBarItem Grid.Column="2">
                <TextBlock
                    Text="{Binding ConnectionSettings, Converter={StaticResource CredentialIdentifierConverter}}"
                    ToolTip="AWS credentials associated with this view"
                    />
            </StatusBarItem>
            <Separator Grid.Column="3" />
            <!--Error status indicator-->
            <StatusBarItem Grid.Column="4" Visibility="{Binding ErrorMessage, Converter={StaticResource HasValueVisibilityConverter}}">
                <Button
                    Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}"
                    Command="{Binding ShowErrorCommand}"
                    CommandParameter="{Binding ErrorMessage, RelativeSource={RelativeSource AncestorType=UserControl}}">
                    <StackPanel Orientation="Horizontal">
                        <images:VsImage
                            Width="16"
                            Height="16"
                            Source="{Binding Source={StaticResource VsImages}, Path=StatusError}" />
                        <TextBlock Margin="3 0 0 0" Text="Error"/>
                    </StackPanel>
                    <Button.ToolTip>
                        <ToolTip MaxWidth="400" DataContext="{Binding Path=PlacementTarget, RelativeSource={x:Static RelativeSource.Self}}" >
                            <TextBlock Text="{Binding DataContext.ErrorMessage}" TextWrapping="WrapWithOverflow" />
                        </ToolTip>
                    </Button.ToolTip>
                </Button>
            </StatusBarItem>
       
            <StatusBarItem Grid.Column="5">
                <!-- Currently this is a spacer -->
            </StatusBarItem>

            <StatusBarItem Grid.Column="6">
                <Button
                    Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}"
                    Command="{Binding FeedbackCommand}"
                    ToolTip="Share CloudWatch Logs Feedback"
                    CommandParameter="{Binding FeedbackSource, RelativeSource={RelativeSource AncestorType=UserControl}}">
                    <images:VsImage
                        Width="16"
                        Height="16"
                        Source="{Binding Source={StaticResource VsImages}, Path=Feedback}" />
                </Button>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</UserControl>
