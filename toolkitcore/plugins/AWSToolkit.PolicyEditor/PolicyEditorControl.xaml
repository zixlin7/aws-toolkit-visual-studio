<commonui:BaseAWSUserControl x:Class="Amazon.AWSToolkit.PolicyEditor.PolicyEditorControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:commonui="clr-namespace:Amazon.AWSToolkit.CommonUI;assembly=AWSToolkit"
    xmlns:local="clr-namespace:Amazon.AWSToolkit.PolicyEditor"             
    Height="auto" Width="auto"    
    >

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/AWSToolkit;component/Themes/Generic.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid>
        <Grid.Resources>

            <ResourceDictionary>
                <ResourceDictionary.MergedDictionaries>
                    <ResourceDictionary Source="pack://application:,,,/AWSToolkit;component/Themes/Generic.xaml"/>
                    <ResourceDictionary Source="PolicyEditorStyles.xaml"/>
                </ResourceDictionary.MergedDictionaries>
            </ResourceDictionary>
        </Grid.Resources>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="1*"/>
            <RowDefinition Height="5"></RowDefinition>
            <RowDefinition Height="3*"></RowDefinition>
        </Grid.RowDefinitions>

        <ToolBar Grid.Row="0" Grid.Column="0" ToolBarTray.IsLocked="True" Name="_ctlToolBar">
            <Button Click="OnAddStatement">
                <Button.Content>
                    <WrapPanel>
                        <Image DataContext="{DynamicResource CommonIcons}" Width="16" Height="16" Source="{Binding AddIcon}"/>
                        <TextBlock> Add Statement</TextBlock>
                    </WrapPanel>
                </Button.Content>
            </Button>
            <Button Click="OnRemoveStatement">
                <Button.Content>
                    <WrapPanel>
                        <Image DataContext="{DynamicResource CommonIcons}" Width="16" Height="16" Source="{Binding RemoveIcon}"/>
                        <TextBlock> Remove Statement</TextBlock>
                    </WrapPanel>
                </Button.Content>
            </Button>
            <Button Click="OnExportStatement" IsEnabled="{Binding HasStatements}">
                <Button.Content>
                    <WrapPanel>
                        <Image DataContext="{DynamicResource CommonIcons}" Width="16" Height="16" Source="{Binding ExportIcon}"/>
                        <TextBlock> Export Policy</TextBlock>
                    </WrapPanel>
                </Button.Content>
            </Button>
            <Button Click="OnImportStatement">
                <Button.Content>
                    <WrapPanel>
                        <Image DataContext="{DynamicResource CommonIcons}" Width="16" Height="16" Source="{Binding ImportIcon}"/>
                        <TextBlock> Import Policy</TextBlock>
                    </WrapPanel>
                </Button.Content>
            </Button>
        </ToolBar>

        <commonui:ToolkitDataGridWrapper Grid.Row="1" Grid.Column="0"  AutoGenerateColumns="False" x:Name="_ctlDataGrid"
                    CanUserAddRows="False" CanUserDeleteRows="False"
                    HorizontalAlignment="Stretch" 
                    HeadersVisibility="Column"
                    ItemsSource="{Binding Statements}"
                    AllowDrop="True"   
                    SelectedCellsChanged="onSelectedCellsChanged"                          
                    Drop="OnDrop"
                    DragOver="OnDrag"
                    >

            <commonui:ToolkitDataGridWrapper.Columns>

                <DataGridTextColumn Width="auto" Header="Effect" Binding="{Binding EffectDisplayLabel, Mode=OneWay}"/>

                <DataGridTemplateColumn Width="auto" Header="Principals" x:Name="_ctlPrincipalColumn">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Grid>
                                <ListView ItemsSource="{Binding PrincipalsLabel}" 
                                          ItemContainerStyle="{DynamicResource  LviBulletList}" 
                                          HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                          BorderThickness="0"
                                          Background="{x:Null}"
                                          />
                            </Grid>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTemplateColumn Width="auto" Header="Actions">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Grid>
                                <ListView ItemsSource="{Binding ActionIdentifiers}" 
                                          ItemContainerStyle="{DynamicResource  LviBulletList}" 
                                          HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                          BorderThickness="0"
                                          Background="{x:Null}"
                                          />
                            </Grid>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTemplateColumn Width="auto" Header="Resources">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Grid>
                                <ListView ItemsSource="{Binding ResourcesLabel}" 
                                          ItemContainerStyle="{DynamicResource  LviBulletList}" 
                                          HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                          BorderThickness="0"
                                          Background="{x:Null}"
                                          />
                            </Grid>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTemplateColumn Width="auto" Header="Conditions">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Grid>
                                <ListView ItemsSource="{Binding Conditions}" 
                                          ItemContainerStyle="{DynamicResource  LviBulletCondition}" 
                                          HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                                          BorderThickness="0"
                                          Background="{x:Null}"
                                          />
                            </Grid>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>


            </commonui:ToolkitDataGridWrapper.Columns>
        </commonui:ToolkitDataGridWrapper>

        <GridSplitter Grid.Row="2" Grid.Column="0" 
                      Height="Auto" Width="Auto" 
                      HorizontalAlignment="Stretch" VerticalAlignment="Stretch" 
                      Background="{DynamicResource awsGridSplitterBackgroundGradientBrushKey}"
                      Foreground="{DynamicResource awsGridSplitterTextForegroundBrushKey}"/>

        <local:StatementEditorControl x:Name="_ctlStatementEditor" Grid.Row="3" Grid.Column="0" 
            HorizontalAlignment="Stretch" Height="auto" IsEnabled="False"/>
        
    </Grid>
</commonui:BaseAWSUserControl>
