<commonui:BaseAWSUserControl x:Class="Amazon.AWSToolkit.EC2.View.Components.QuickLaunchAMIListControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:commonui="clr-namespace:Amazon.AWSToolkit.CommonUI;assembly=AWSToolkit"             
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:designData="clr-namespace:Amazon.AWSToolkit.EC2.View.DesignData"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance designData:QuickLaunchDesignTimeData, 
                            IsDesignTimeCreatable=True}"
             Background="Transparent"
             >

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/AWSToolkit;component/Themes/DefaultTheme.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <Style x:Key="QuickLaunchListBoxItemStyle" TargetType="ListBoxItem">
                <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                <Setter Property="Margin" Value="4" />
                <Setter Property="TextBlock.Foreground" Value="{DynamicResource awsDefaultControlForegroundBrushKey}"></Setter>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ListBoxItem">
                            <Border x:Name="Root"
                                    BorderBrush="{DynamicResource awsListBoxPanelItemBackgroundBrushKey}"
                                    Background="{DynamicResource awsListBoxPanelItemBackgroundBrushKey}"
                                    BorderThickness="2"
                                    CornerRadius="4"
                                    Padding="4"
                                    >
                                <ContentPresenter Content="{TemplateBinding Content}"
                                                      ContentTemplate="{TemplateBinding ContentTemplate}"
                                                      HorizontalAlignment="Left"
                                                      VerticalAlignment="Center"
                                                      />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="BorderBrush" Value="{DynamicResource awsListBoxPanelItemHoverBorderBrushKey}" TargetName="Root" />
                                </Trigger>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="{DynamicResource awsListBoxPanelItemSelectedBorderBrushKey}" TargetName="Root" />
                                    <Setter Property="Background" Value="{DynamicResource awsListBoxPanelItemSelectedBackgroundBrushKey}" />
                                    <Setter Property="TextBlock.Foreground" Value="Black"></Setter>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <DataTemplate x:Key="QuickLaunchItemTemplate">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <!-- need fixed width at present to force text to wrap -->
                        <ColumnDefinition Width="450" />
                    </Grid.ColumnDefinitions>
                    <Image Width="16" Height="16" Source="{Binding PlatformIcon, Mode=OneWay}"
                           VerticalAlignment="Top"
                           Grid.RowSpan="2"
                           />

                    <Grid Grid.Row="0" Grid.Column="1" Margin="4,0,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <TextBlock Margin="0"
                                TextWrapping="NoWrap" 
                                TextTrimming="WordEllipsis" 
                                FontWeight="Bold" 
                                FontSize="12"
                                VerticalAlignment="Center" 
                                Text="{Binding Title}"
                                Foreground="{TemplateBinding TextBlock.Foreground}"
                                />
                        <StackPanel Orientation="Horizontal" 
                                    Grid.Column="1" 
                                    Margin="8,0,0,0">
                            <RadioButton GroupName="ArchitectureType" IsChecked="{Binding Is64BitSelected}"
                                         IsEnabled="{Binding Is64BitEnabled}"  Margin="5,0,5,0"
                                         FontWeight="Bold" FontSize="12" FontStyle="Italic"
                                         Foreground="{TemplateBinding TextBlock.Foreground}">
                                64 Bit
                            </RadioButton>
                            <RadioButton GroupName="ArchitectureType" IsChecked="{Binding Is32BitSelected}"
                                         IsEnabled="{Binding Is32BitEnabled}" Margin="5,0,5,0" 
                                         FontWeight="Bold" FontSize="12"  FontStyle="Italic"
                                         Foreground="{TemplateBinding TextBlock.Foreground}">
                                32 Bit
                            </RadioButton>
                        </StackPanel>
                    </Grid>

                    <Grid Grid.Row="1" Grid.Column="1" Margin="4,0,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="29*" />
                            <ColumnDefinition Width="70*"/>
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <TextBlock TextWrapping="Wrap" 
                                   Text="{Binding Description}" 
                                   Margin="0,4,0,0" Grid.ColumnSpan="2"
                                   Foreground="{TemplateBinding TextBlock.Foreground}"
                                   />
                        <Image Width="16" Height="16"
                               Source="..\..\Resources\Images\free_tier_eligible_sml.png"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Right"
                               Grid.Column="1"
                               ToolTip="Free tier eligible if used with a micro instance."
                               Visibility="{Binding FreeTier, Converter={StaticResource Bool2VisConverter}}" Margin="0,2"
                               />
                    </Grid>
                </Grid>
            </DataTemplate>

            <ControlTemplate TargetType="ListBox" x:Key="QuickLaunchControlTemplate">
                <ScrollViewer HorizontalScrollBarVisibility="Hidden"
                              VerticalScrollBarVisibility="Auto"
                              Focusable="false" 
                              Padding="{TemplateBinding Padding}"
                              CanContentScroll="True">
                    <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                </ScrollViewer>
            </ControlTemplate>

        </ResourceDictionary>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StackPanel Orientation="Horizontal" x:Name="_filterControls">
            <Label VerticalAlignment="Bottom" Style="{StaticResource awsLabelBaseStyle}">
                Filter:
            </Label>
            <RadioButton x:Name="_allPlatforms" 
                         GroupName="PlatformFilters" 
                         Click="PlatformFilter_Click"
                         Tag="All"
                         Margin="0,0,8,0"
                         Style="{DynamicResource awsRadioButtonBaseStyle}">
                Show _all
            </RadioButton>
            <RadioButton x:Name="_linuxOnly" 
                         GroupName="PlatformFilters" 
                         Click="PlatformFilter_Click"
                         Tag="Linux"
                         Margin="0,0,8,0"
                         Style="{DynamicResource awsRadioButtonBaseStyle}">
                _Linux only
            </RadioButton>
            <RadioButton x:Name="_windowsOnly" 
                         GroupName="PlatformFilters" 
                         Click="PlatformFilter_Click"
                         Tag="Windows"
                         Style="{DynamicResource awsRadioButtonBaseStyle}">
                _Windows only
            </RadioButton>
        </StackPanel>

        <Border Grid.Row="1" 
                BorderBrush="{DynamicResource awsDefaultControlBorderBrushKey}" 
                BorderThickness="2">
            <ListBox x:Name="_amiList" 
                 ItemContainerStyle="{StaticResource QuickLaunchListBoxItemStyle}"
                 ItemTemplate="{StaticResource QuickLaunchItemTemplate}"
                 Template="{StaticResource QuickLaunchControlTemplate}"
                 SelectionChanged="_amiList_SelectionChanged"
                 HorizontalContentAlignment="Stretch"
                 ItemsSource="{Binding}"
                 />
        </Border>
    </Grid>

</commonui:BaseAWSUserControl>
