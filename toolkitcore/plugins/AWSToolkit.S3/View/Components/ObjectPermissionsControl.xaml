<commonui:BaseAWSUserControl
    x:Class="Amazon.AWSToolkit.S3.View.Components.ObjectPermissionsControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:commonui="clr-namespace:Amazon.AWSToolkit.CommonUI;assembly=AWSToolkit"
    Width="300"
    Height="300">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/AWSToolkit;component/Themes/Generic.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>

    <DockPanel>
        <ToolBar DockPanel.Dock="Top" ToolBarTray.IsLocked="True">
            <Button Click="OnAddPermission">
                <Button.Content>
                    <WrapPanel>
                        <Image
                            Width="16"
                            Height="16"
                            DataContext="{DynamicResource CommonIcons}"
                            Source="{Binding AddIcon}" />
                        <TextBlock>Add</TextBlock>
                    </WrapPanel>
                </Button.Content>
            </Button>
            <Button Click="OnRemovePermission">
                <Button.Content>
                    <WrapPanel>
                        <Image
                            Width="16"
                            Height="16"
                            DataContext="{DynamicResource CommonIcons}"
                            Source="{Binding RemoveIcon}" />
                        <TextBlock>Remove</TextBlock>
                    </WrapPanel>
                </Button.Content>
            </Button>
        </ToolBar>


        <commonui:ToolkitDataGridWrapper
            x:Name="_ctlPermissionDataGrid"
            HorizontalAlignment="Stretch"
            AutoGenerateColumns="False"
            CanUserAddRows="False"
            CanUserDeleteRows="False"
            CellStyle="{DynamicResource awsDataGridCellCentering}"
            HeadersVisibility="Column"
            ItemsSource="{Binding PermissionEntries}">
            <commonui:ToolkitDataGridWrapper.Columns>

                <DataGridTemplateColumn Width="1*" Header="Grantee">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <!--
                                use LostFocus instead of PropertyChanged so update does not
                                fire for every keystroke in textbox component, slowing UI
                            -->
                            <ComboBox
                                IsEditable="True"
                                Style="{DynamicResource awsComboBoxStyle}"
                                Text="{Binding GranteeFormatted, UpdateSourceTrigger=PropertyChanged}">
                                <ComboBoxItem Uid="LogDelivery">Log Delivery</ComboBoxItem>
                                <ComboBoxItem Uid="AuthenticatedUsers">Authenticated Users</ComboBoxItem>
                                <ComboBoxItem Uid="AllUsers">Everyone</ComboBoxItem>
                            </ComboBox>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTemplateColumn Width="1*" Header="Open/Download">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <CheckBox
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                ClickMode="Press"
                                IsChecked="{Binding OpenDownload, UpdateSourceTrigger=PropertyChanged}" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTemplateColumn Width="1*" Header="View Permissions">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <CheckBox
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                ClickMode="Press"
                                IsChecked="{Binding ViewPermissions, UpdateSourceTrigger=PropertyChanged}" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTemplateColumn Width="1*" Header="Edit Permissions">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <CheckBox
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                ClickMode="Press"
                                IsChecked="{Binding EditPermissions, UpdateSourceTrigger=PropertyChanged}" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </commonui:ToolkitDataGridWrapper.Columns>
        </commonui:ToolkitDataGridWrapper>
    </DockPanel>
</commonui:BaseAWSUserControl>
